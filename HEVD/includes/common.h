#include <Windows.h>
#include <stdio.h>
#include <Psapi.h>
#include <WinNT.h>

#define DRIVER "\\\\.\\HacksysExtremeVulnerableDriver"
#define SHARED_MEMORY_NAME "HackSysExtremeVulnerableDriverSharedMemory"

#define HEVD_IOCTL_STACKOVERFLOW 0x222003
#define HEVD_IOCTL_STACKOVERFLOW_GS 0x222007
#define HEVD_IOCTL_DOUBLEFETCH 0x222037
#define HEVD_IOCTL_NONPAGEDPOOLOVERFLOW 0x22200F

ULONGLONG GetDriverBase(void);
ULONGLONG GetKernelBase(void);
HANDLE GetDeviceHandle(void);

int CheckProcessors(void);